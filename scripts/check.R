dat <- read.csv('data/network-model-outcomes_v3.csv')
dat2 <- read.csv('data/network-model-outcomes_v5.csv')
dat3 <- rbind(dat, dat2) %>% distinct()

allcombo <- expand.grid(Erosion = erosion$press,
                                    CoastalDev = cdev$press,
                                    ExtremeRainfall = rain$press,
                                    Drought = drought$press,
                                    Cyclones = cyc$press,
                                    SeaLevelRise = slr$press, 
                        Sediment = c('High', 'Low'), Relief = c('High', 'Low'), setting = names(edge.cons.scenarios)) %>% 
  mutate(across(Erosion:SeaLevelRise, ~str_extract(., '(?<=_).*'))) %>% 
  mutate(across(Erosion:SeaLevelRise, ~as.numeric(.))) %>% 
  mutate(Tide = sapply(str_split(setting, '_'), '[', 1),
         ecological_connectivity = sapply(str_split(setting, '_'), '[', 2),
         Coastal_squeeze = sapply(str_split(setting, '_'), '[', 3)) %>% 
  filter(ecological_connectivity == 'Medium') %>% 
  select(-c(setting, ecological_connectivity)) %>% 
  mutate(across(Erosion:SeaLevelRise, ~case_when(. == 0~'Not present', . == 0.25~'Low', . == 0.5 ~ 'Medium', . == 0.75 ~ 'High'))) %>% 
  rename(Shoreline_change = Erosion, Landuse_intensity = CoastalDev)
  
dat4 <- dat3 %>% unite('var', Relief, Shoreline_change, Landuse_intensity, ExtremeRainfall,
                      Drought, Cyclones, SeaLevelRise, Sediment, Tide, Coastal_squeeze) %>% 
  bind_cols(select(dat3, -Probability_gain_neutral)) %>% 
  group_by(var, Relief, Shoreline_change, Landuse_intensity, ExtremeRainfall,
           Drought, Cyclones, SeaLevelRise, Sediment, Tide, Coastal_squeeze) %>%
  summarise(Probability_gain_neutral = mean(Probability_gain_neutral))

combo2 <- allcombo %>% unite('var', Relief, Shoreline_change, Landuse_intensity, ExtremeRainfall,
                             Drought, Cyclones, SeaLevelRise, Sediment, Tide, Coastal_squeeze) %>% 
  bind_cols(allcombo)

# what is missing

miss <- combo2 %>% filter(!var %in% dat4$var)
write.csv(miss, 'data/missing-combos.csv', row.names = F)
